[general]
# General information.  See the fully annotated example more information
# https://github.com/jgoerzen/offlineimap/blob/master/offlineimap.conf

metadata = ~/.offlineimap
accounts = school,gmail
maxsyncaccounts = 2
socktimeout = 60
ui = TTY.TTYUI

[mbnames]
# This populates a mailbox file for mutt to use.
#

enabled = yes
filename = ~/.mail_configs/mutt/muttmailboxes
header = "mailboxes "

# Exclude from the list of mailboxes any folder matching the
# regex below.  Works for all accounts
folderfilter = lambda accountname, foldername: not re.search('(^bak.*|.*drafts$|.*spam$|.*sent$|.*trash$)', foldername)

peritem = "+%(accountname)s/%(foldername)s"
sep = " "
footer = "\n"

[Account school]
localrepository = local-school
remoterepository = remote-school

# Calls imapfilter to use perform filtering on
# the school mailbox before synching
presynchook = imapfilter -vc ~/.mail_configs/imapfilter/school.lua

[Account gmail]
localrepository = local-gmail
remoterepository = remote-gmail

[Repository local-school]
type = Maildir
localfolders = /ABSOLUTE/PATH/TO/.mail/school 

[Repository remote-school]
type = IMAP
remotehost = smtp.school.edu
remoteuser = username@school.edu
remotepass = password
ssl = yes
realdelete = yes

# Change any spaces in folder names to underscores, and change
# uppercase characters to lowercase.
nametrans = lambda foldername: re.sub (' ', '_', foldername.lower())

# Don't synchronize folders with the following names
folderfilter = lambda foldername: foldername not in ['Chats', 'Contacts', 'Emailed Contacts', 'Queue']


[Repository local-gmail]
type = Maildir
localfolders = /ABSOLUTE/PATH/TO/.mail/gmail


[Repository remote-gmail]
type = Gmail
remotehost = imap.gmail.com
remoteuser = user.name@gmail.com
remotepass = password
ssl = yes
realdelete = no
# Gmail specific: normally, labels in gmail get synchnorized as something
# like [Gmail]label, so we want to remove that.
#
# Also, we change the names of some of the folders, replace spaces with underscores,
# and force everything to lowercase.
nametrans = lambda foldername: re.sub ('^\[gmail\]', 'bak',
                               re.sub ('sent_mail', 'sent',
                               re.sub ('starred', 'flagged',
                               re.sub (' ', '_', foldername.lower()))))

# Don't synchronize the All Mail folder
folderfilter = lambda foldername: foldername not in ['[Gmail]/All Mail']
